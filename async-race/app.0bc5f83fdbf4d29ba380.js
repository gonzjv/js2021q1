(()=>{"use strict";class e{constructor(e="div",t=[]){this.element=document.createElement(e),this.element.classList.add(...t)}}class t extends e{constructor(e,t,n,i){super("button",["button"]),this.root=e,this.id=t,this.type=n,this.innerHtml=i,this.element.setAttribute("id",this.id),this.element.setAttribute("type",this.type)}render(){var e;return this.element.innerHTML=this.innerHtml,null===(e=this.root)||void 0===e||e.appendChild(this.element),this.element}}class n extends e{constructor(e){super("div",["logo","roboto-11"]),this.root=e}render(){var e;return this.element.innerHTML="turtle race",null===(e=this.root)||void 0===e||e.appendChild(this.element),this.element}}class i extends e{constructor(e){super("ul",["nav-wrap"]),this.root=e}render(){var e;return null===(e=this.root)||void 0===e||e.appendChild(this.element),this.element}}class r extends e{constructor(e){super("nav",["nav"]),this.root=e}render(){var e;return null===(e=this.root)||void 0===e||e.appendChild(this.element),this.element.appendChild(new i(this.element).render()),this.element}}class s extends e{constructor(e){super("header",["header"]),this.root=e}render(){var e;return null===(e=this.root)||void 0===e||e.appendChild(this.element),this.element.appendChild(new n(this.element).render()),this.element.appendChild(new r(this.element).render()),this.element.appendChild(new t(this.element,"to-garage","button","to garage").render()),this.element.appendChild(new t(this.element,"to-winners","button","to winners").render()),this.element}}class a extends e{constructor(e){super("footer",["footer"]),this.root=e}render(){var e;return this.element.innerHTML='\n    <div>Icons made by <a href="https://www.freepik.com" title="Freepik">Freepik</a> from \n    <a href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a></div>\n    ',null===(e=this.root)||void 0===e||e.appendChild(this.element),this.element}}const l="http://localhost:3000",o=`${l}/garage`,d=`${l}/winners`,h=async(e,t=10)=>{const n=await fetch(`${d}?_page=${e}&_limit=${t}`);return{items:await n.json(),count:Number(n.headers.get("X-Total-Count"))}};class c extends e{constructor(e,t,n,i){super(t,[`${t}-elem`]),this.root=e,this.h_=t,this.id=n,this.text=i,this.element.setAttribute("id",this.id)}render(){var e;return this.element.innerHTML=this.text,null===(e=this.root)||void 0===e||e.appendChild(this.element),this.element}}class m extends e{constructor(e,t,n){super("p",["p-elem"]),this.root=e,this.id=t,this.text=n,this.element.setAttribute("id",this.id)}render(){var e;return this.element.innerHTML=this.text,null===(e=this.root)||void 0===e||e.appendChild(this.element),this.element}}class p extends e{constructor(e,t){super("div",["car"]),this.root=e,this.car=t,this.element.style.fill=this.car.color}render(){var e;return null===(e=this.root)||void 0===e||e.appendChild(this.element),this.element.innerHTML=`\n    <form class="car-controls" id="car-controls-${this.car.id}">\n      <input class="car-buttons" id="car-select-${this.car.id}" name="car-select" type="button" value="Select"></input>\n      <input class="car-buttons" id="car-delete-${this.car.id}" name="car-delete"type="button" value="Delete"></input>\n      <p>${this.car.name}</p>\n    </form>\n      <svg height="50px" viewBox="1 -160 511 511" width="50px" xmlns="http://www.w3.org/2000/svg"><path d="m498.542969 80.964844c-28.695313-20.128906-69.269531-24.351563-98.253907-24.351563h-6.351562l-101.007812-47.136719c-12.582032-5.875-26.574219-8.976562-40.457032-8.976562h-89.164062c-8.664063 0-17.09375 1.730469-25.058594 5.140625l-92.566406 39.671875c-5.082032 2.179688-10.460938 3.285156-15.992188 3.285156h-6.160156c-12.972656-.003906-23.53125 10.554688-23.53125 23.53125v50.914063c0 11.238281 8.007812 20.953125 19.039062 23.097656l29.679688 5.773437c3.667969 22.617188 23.324219 39.941407 46.957031 39.941407 17.679688 0 33.125-9.699219 41.328125-24.050781h254.023438c8.203125 14.351562 23.648437 24.050781 41.328125 24.050781 17.675781 0 33.125-9.699219 41.328125-24.050781h14.785156c12.972656 0 23.53125-10.554688 23.53125-23.53125v-37.441407c0-10.285156-5.03125-19.957031-13.457031-25.867187zm-211.957031-57.894532 71.882812 33.542969h-107.035156l-35.242188-41.113281h36.277344c11.710938 0 23.507812 2.617188 34.117188 7.570312zm-90.148438-7.570312 35.242188 41.113281h-12.714844c-4.835938 0-9.417969-2.105469-12.566406-5.78125l-30.285157-35.332031zm-53.960938 137.304688c.503907-2.769532.78125-5.617188.78125-8.53125 0-3.195313-.320312-6.394532-.953124-9.507813-.824219-4.058594-4.78125-6.679687-8.839844-5.859375-4.0625.824219-6.683594 4.785156-5.859375 8.84375.433593 2.128906.652343 4.324219.652343 6.523438 0 17.964843-14.617187 32.578124-32.582031 32.578124-17.964843 0-32.578125-14.613281-32.578125-32.578124 0-17.964844 14.613282-32.582032 32.578125-32.582032 4.550781 0 8.945313.917969 13.070313 2.726563 3.789062 1.660156 8.214844-.066407 9.878906-3.859375 1.664062-3.792969-.0625-8.214844-3.855469-9.878906-6.035156-2.644532-12.460937-3.988282-19.09375-3.988282-23.632812 0-43.289062 17.324219-46.957031 39.941406l-26.816406-5.214843c-4-.777344-6.90625-4.300781-6.90625-8.375v-27.382813h8.535156c4.140625 0 7.5-3.359375 7.5-7.5s-3.359375-7.5-7.5-7.5h-8.53125v-8.53125c0-4.707031 3.828125-8.53125 8.53125-8.53125h6.160156c7.574219 0 14.941406-1.515625 21.902344-4.496094l92.5625-39.671874c4.058594-1.738282 8.273438-2.890626 12.589844-3.476563l38.265625 44.640625c6 7.003906 14.730469 11.019531 23.953125 11.019531h181.324218c20.042969 0 55.804688 2.347657 82.300782 17.0625h-2.136719c-4.144531 0-7.5 3.359375-7.5 7.5 0 4.144531 3.355469 7.5 7.5 7.5h16.238281c.199219 1.03125.308594 2.085938.308594 3.15625v13.910157h-23.316406c-8.203125-14.351563-23.648438-24.046876-41.328125-24.046876-17.679688 0-33.125 9.695313-41.328125 24.046876h-14.78125c-4.144532 0-7.5 3.355468-7.5 7.5 0 4.140624 3.355468 7.5 7.5 7.5h9.308594c-.503907 2.769531-.78125 5.617187-.78125 8.53125 0 2.914062.277343 5.761718.78125 8.53125zm289.878907 24.046874c-17.964844 0-32.582031-14.613281-32.582031-32.578124 0-17.964844 14.617187-32.582032 32.582031-32.582032 17.964843 0 32.582031 14.617188 32.582031 32.582032 0 17.964843-14.617188 32.578124-32.582031 32.578124zm56.113281-24.046874h-9.3125c.503906-2.769532.78125-5.617188.78125-8.53125 0-2.914063-.277344-5.761719-.78125-8.53125h17.84375v8.53125c0 4.703124-3.828125 8.53125-8.53125 8.53125zm0 0"/><path d="m344.179688 120.742188h-100.460938l-16.988281-22.652344c-4.421875-5.894532-11.460938-9.414063-18.828125-9.414063h-32.0625c-2.84375 0-5.4375 1.605469-6.707032 4.148438-1.273437 2.539062-1 5.582031.707032 7.851562l19.238281 25.652344c4.417969 5.894531 11.457031 9.414063 18.824219 9.414063h136.277344c4.140624 0 7.5-3.359376 7.5-7.5 0-4.144532-3.359376-7.5-7.5-7.5zm-136.277344 0c-2.671875 0-5.222656-1.277344-6.824219-3.414063l-10.238281-13.652344h17.0625c2.671875 0 5.222656 1.277344 6.828125 3.414063l10.238281 13.652344zm0 0"/><path d="m95.675781 128.757812c-8.554687 0-15.515625 6.960938-15.515625 15.515626 0 8.554687 6.960938 15.515624 15.515625 15.515624 8.558594 0 15.515625-6.960937 15.515625-15.515624 0-8.554688-6.957031-15.515626-15.515625-15.515626zm0 0"/><path d="m432.355469 128.757812c-8.554688 0-15.515625 6.960938-15.515625 15.515626 0 8.554687 6.960937 15.515624 15.515625 15.515624 8.554687 0 15.515625-6.960937 15.515625-15.515624 0-8.554688-6.960938-15.515626-15.515625-15.515626zm0 0"/></svg>\n      `,this.element}}class u{constructor(e,t=[]){this.element=document.createElement("form"),this.element.setAttribute("id",e),this.element.classList.add(...t)}}class w extends u{constructor(e){super("create",["form-create"]),this.root=e,this.element.setAttribute("name","form-create")}render(){var e;return null===(e=this.root)||void 0===e||e.appendChild(this.element),this.element.innerHTML='\n        <label for="create-name"></label>\n        <input class="input" id="create-name" name="create-name" type="text" placeholder="Car name">\n        <label for="create-color"></label>\n        <input class="color" id="create-color" name="create-color" type="color">\n        <button id="create-button" class="button" type="submit">Create</button>        \n    ',this.element}}class v extends u{constructor(e){super("update",["form-update"]),this.root=e,this.element.setAttribute("name","form-update")}render(){var e;return null===(e=this.root)||void 0===e||e.appendChild(this.element),this.element.innerHTML='\n        <label for="update-name"></label>\n        <input class="input" id="update-name" name="update-name" type="text" placeholder="update car name">\n        <label for="update-color"></label>\n        <input class="color" id="update-color" name="update-color" type="color">\n        <button id="update-button" class="button" type="submit">Update</button>        \n    ',this.element}}class g extends e{constructor(e){super("div",["garage"]),this.root=e}async render(){var e;const{items:t,count:n}=await(async(e,t=7)=>{const n=await fetch(`${o}?_page=${e}&_limit=${t}`);return{items:await n.json(),count:Number(n.headers.get("X-Total-Count"))}})(1);return null===(e=this.root)||void 0===e||e.appendChild(this.element),this.element.appendChild(new w(this.element).render()),this.element.appendChild(new v(this.element).render()),this.element.appendChild(new c(this.element,"h3","garage-header","garage").render()),this.element.appendChild(new c(this.element,"h5","",`Total cars: ${n}`).render()),this.element.appendChild(new m(this.element,"page-number","Page: 1").render()),t.map((e=>this.element.appendChild(new p(this.element,e).render()))),this.element}}class C extends e{constructor(e,t){super("div",["winner-table"]),this.root=e,this.winners=t}render(){var e;return this.element.innerHTML=`\n    <table class ="table" cellspacing="15" cellpadding="0" border="0">\n      <thead>\n        <th>Number</th>\n        <th>Car</th>\n        <th>Name</th>\n        <th>Wins</th>\n        <th>Best time (sec.)</th>\n      </thead>\n      <tbody>\n  ${this.winners.map(((e,t)=>`\n        <tr>\n        <td>${t+1}</td>\n        <td>${e.id}</td>\n        <td>name</td>\n        <td>${e.wins}</td>\n        <td>${e.time}</td>\n        </tr>\n      `)).join("")}\n      </tbody>\n    </table>\n\n    `,null===(e=this.root)||void 0===e||e.appendChild(this.element),this.element}}class b extends e{constructor(e){super("div",["winners"]),this.root=e}async render(){var e;const{items:t,count:n}=await h(1);return null===(e=this.root)||void 0===e||e.appendChild(this.element),this.element.appendChild(new c(this.element,"h3","winners-header","winners").render()),this.element.appendChild(new c(this.element,"h5","",`Total winners: ${n}`).render()),this.element.appendChild(new m(this.element,"page-number","Page: 1").render()),this.element.appendChild(new C(this.element,t).render()),this.element}}class y extends e{constructor(e,t){super("main",["main"]),this.root=e,this.view=t}async render(){var e;return null===(e=this.root)||void 0===e||e.appendChild(this.element),"garage"===this.view&&this.element.appendChild(await new g(this.element).render()),"winners"===this.view&&this.element.appendChild(await new b(this.element).render()),this.element}}class f extends e{constructor(e,t){super("div",["main-wrap"]),this.root=e,this.view=t}async render(){var e;return null===(e=this.root)||void 0===e||e.appendChild(this.element),this.element.appendChild(await new y(this.element,this.view).render()),this.element}}class $ extends e{constructor(e){super("aside",["cover","hidden"]),this.root=e,this.element.setAttribute("id","cover")}render(){var e;return null===(e=this.root)||void 0===e||e.appendChild(this.element),this.element}}class x{constructor(e,t){this.root=e,this.view=t,this.page=document.createElement("div")}async render(){var e;return this.page.classList.add("page"),null===(e=this.root)||void 0===e||e.appendChild(this.page),this.page.appendChild(new s(this.page).render()),this.page.appendChild(await new f(this.page,this.view).render()),this.page.appendChild(new a(this.page).render()),this.page.appendChild(new $(this.page).render()),this.page}}class L{constructor(e,t){this.root=e,this.view=t,this.application=document.createElement("div"),this.application.classList.add("app")}async render(){var e;null===(e=this.root)||void 0===e||e.appendChild(this.application);try{this.application.appendChild(await new x(this.application,this.view).render())}catch(e){throw Error("ERROR: fetching data from DB is not available. Check DB status")}return this.application}}class E{constructor(){this.toGarage=document.getElementById("to-garage"),this.toWinners=document.getElementById("to-winners")}addListeners(){var e,t;null===(e=this.toGarage)||void 0===e||e.addEventListener("click",(()=>{window.location.href="#garage"})),null===(t=this.toWinners)||void 0===t||t.addEventListener("click",(()=>{window.location.href="#winners"}))}}class T{constructor(){this.create=document.getElementById("create"),this.garage=document.querySelector(".garage"),this.selectedCar={name:"initial-name",color:"initial color",id:0},this.createName=document.getElementById("create-name"),this.createColor=document.getElementById("create-color"),this.updateName=document.getElementById("update-name"),this.updateColor=document.getElementById("update-color"),this.rootNode=document.getElementById("rootNode")}async addListeners(){this.garage.addEventListener("click",(async e=>{if(/create-button/.test(e.target.id)&&(e.preventDefault(),await(async e=>fetch(o,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}))({name:this.createName.value,color:this.createColor.value}),window.location.href=`#garage-create-${this.createName.value}`),/car-delete/.test(e.target.id)){const t=e.target.id.replace(/[^0-9]*/,"");await(async e=>(await fetch(`${o}/${e}`,{method:"DELETE"})).json())(t),window.location.href=`#garage-delete-car-id${t}`}if(/car-select/.test(e.target.id)){const t=e.target.id.replace(/[^0-9]*/,"");this.selectedCar=await(async e=>(await fetch(`${o}/${e}`)).json())(t),this.updateName.value=this.selectedCar.name,this.updateColor.value=this.selectedCar.color}/update-button/.test(e.target.id)&&(e.preventDefault(),this.selectedCar.name=this.updateName.value,this.selectedCar.color=this.updateColor.value,await(async e=>fetch(`${o}/${e.id}`,{method:"PUT",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}))({name:this.selectedCar.name,color:this.selectedCar.color,id:this.selectedCar.id}),window.location.href=`#garage-update-${this.selectedCar.name}`)}))}}const N=document.getElementById("rootNode");if(!N)throw Error("App root element not found");const B={name:"default",component:async()=>{await new L(N,"garage").render()}};window.onload=async()=>{await B.component(),(new E).addListeners(),await(new T).addListeners()};const H=[{name:"garage",component:async()=>{N.innerHTML="",await new L(N,"garage").render(),(new E).addListeners(),(new T).addListeners()}},{name:"winners",component:async()=>{N.innerHTML="",await new L(N,"winners").render(),(new E).addListeners()}}];window.onpopstate=()=>{var e;let t="garage";/garage/.test(window.location.hash)&&(t="garage"),/winners/.test(window.location.hash)&&(t="winners"),null===(e=H.find((e=>e.name===t))||B)||void 0===e||e.component()}})();